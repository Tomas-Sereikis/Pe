!function(){function a(){}function b(){if(this instanceof b==!1)throw new ReferenceError;this.stack=[],this.evaluations=[],this.queue=[],this.locked=!1,this.triggers=[],this.closed=!1,this.fails=[]}var c=this;a.prototype=new Error;var d=function(a){if("function"!=typeof a)throw new TypeError},e=function(){if(this.closed)throw new a},f=function(a,b,c,d){var e=!1,f=!1,g={async:function(){return e=!0,function(){f===!1&&c()}},fail:function(a){f=!0,d(a)}};a.apply(g,b),e||f!==!1||c()},g=function(a){for(var b=[],c=0;c<this.stack.length;c++){var d=this.stack[c],e="undefined"==typeof d.process?-1:d.process;a>e&&(b.push({evaluation:this.evaluations[a],params:this.stack[c].params}),d.process=a)}return b},h=function(){for(;this.triggers.length;)this.triggers.shift()()},i=function(a){this.locked=!1,k.call(this,a)},j=function(a){this.fails.forEach(function(b){b(a)})},k=function(a){if(this.isLocked())return void this.triggers.push(a);if(this.queue.length>0){this.locked=!0;var b=this.queue[0];if(b.length>0){var d=b.shift(),e=this;try{f(d.evaluation,d.params,function(){i.call(e,a)},function(b){j.call(e,b),i.call(e,a)})}catch(g){j.call(this,g),i.call(this,a)}}else this.queue.shift(),i.call(this,a)}else this.locked=!1,a.call(c),h.call(this)},l=function(a,b){return b.length>0?(a.push(b),!0):!1};b.stackFromArray=function(){var a=new b;return[].forEach.call(arguments,function(b){a.push(b)}),a},b.prototype={push:function(a){e.call(this),a=[].slice.call(arguments),this.stack.push({params:a});var b=!1;return this.evaluations.forEach(function(a,c){l(this.queue,g.call(this,c))&&(b=!0)},this),b&&k.call(this,function(){}),this},evaluate:function(a){d(a),e.call(this),this.evaluations.push(a);var b=this.evaluations.length-1;return l(this.queue,g.call(this,b))&&k.call(this,function(){}),this},"catch":function(a){return d(a),-1===this.fails.indexOf(a)&&this.fails.push(a),this},finish:function(a){d(a),this.closed=!0,k.call(this,function(){a()})},isLocked:function(){return this.locked},isClosed:function(){return this.closed}};var m=c.Pe;c.Pe=b,c.Pe.noConflict=function(){return c.Pe=m,b}}();
//# sourceMappingURL=pe.min.js.map