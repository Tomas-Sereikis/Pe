!function(){function a(){}function b(a){if("function"!=typeof a)throw new TypeError}function c(a){a.$locked=!0}function d(a){a.$locked=!1}function e(a,b){b.forEach(function(b){a.$processing.push(b)})}function f(a,b,c){var d=!1,e=!1,f={async:function(){return d=!0,function(){e===!1&&b()}},fail:function(a){e=!0,c(a)}};a.worker.apply(f,a.params),d||e!==!1||b()}function g(a,b){var c=[];return a.$stack.forEach(function(d){var e="undefined"==typeof d.position?-1:d.position;b>e&&(d.position=b,c.push({worker:a.$workers[b],params:d.params}))}),c}function h(a){a.$workers.forEach(function(b,c){e(a,g(a,c))})}function i(a,b){a.$fails.forEach(function(a){a(b)})}function j(a,b){"function"==typeof b&&a.$callbacks.push(b)}function k(a){for(var b;b=a.$callbacks.shift();)b()}function l(a,b){d(a),m(a,b)}function m(a,b){if(a.isLocked())return void j(a,b);if(a.$processing.length>0){c(a);var e=a.$processing.shift();try{var g=function(){l(a,b)},h=function(c){i(a,c),l(a,b)};f(e,g,h)}catch(m){i(a,m),l(a,b)}}else d(a),"function"==typeof b&&b(),k(a)}function n(a){a.$closed=!0}function o(b){if(b.$closed)throw new a}function p(a,b){a.$stack.push({params:b})}function q(a,b){return a.$workers.push(b),a.$workers.length-1}function r(a){return{fail:function(c){return b(c),-1===a.$fails.indexOf(c)&&a.$fails.push(c),a}}}function s(){if(this instanceof s==!1)throw new ReferenceError;var a=r(this),b=[],c=[],d=[],e=[],f=[],g=!1,h=!1;Object.defineProperties(this,{$stack:{writable:!1,value:b},$workers:{writable:!1,value:c},$processing:{writable:!1,value:d},$callbacks:{writable:!1,value:e},$fails:{writable:!1,value:f},$closed:{enumerable:!0,get:function(){return g},set:function(a){if("boolean"!=typeof a)throw new TypeError;g===!1&&(g=a)}},$locked:{enumerable:!0,get:function(){return h},set:function(a){if("boolean"!=typeof a)throw new TypeError;h=a}},on:{enumerable:!0,get:function(){return a}}})}if(a.prototype=new Error,s.stackFromArray=function(){var a=new s;return[].forEach.call(arguments,function(b){a.push(b)}),a},s.prototype={push:function(a){return o(this),a=Array.prototype.slice.call(arguments),p(this,a),h(this),m(this),this},evaluate:function(a){b(a),o(this);var c=q(this,a);return e(this,g(this,c)),m(this),this},"catch":function(a){return this.on.fail(a),this},finish:function(a){b(a),n(this),m(this,a)},isLocked:function(){return this.$locked},isClosed:function(){return this.$closed}},"undefined"!=typeof module&&module.exports)module.exports=s;else if("undefined"!=typeof define&&define.amd)define([],function(){return s});else{var t=this,u=t.Pe;t.Pe=s,t.Pe.noConflict=function(){return t.Pe=u,s}}}();
//# sourceMappingURL=pe.min.js.map